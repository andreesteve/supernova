<html>
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script type="text/javascript" src="libs/klass.js"></script>
<script type="text/javascript" src="libs/gl-matrix-min.js"></script>
<script type="text/javascript" src="libs/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="gx/gx.js"></script>
<script type="text/javascript" src="gx/gx.drawingContext.js"></script>
<script type="text/javascript" src="gx/gx.shader.js"></script>
<script type="text/javascript" src="gx/gx.buffer.js"></script>
<script type="text/javascript" src="gx/gx.texture.js"></script>
<script type="text/javascript" src="gx/gx.model.js"></script>
<script type="text/javascript" src="gx/gx.input.js"></script>
<script type="text/javascript" src="gx/gx.camera.js"></script>
<script type="text/javascript" src="gx/gx.object.js"></script>
<script type="text/javascript" src="gx/gx.scene.js"></script>
<script type="text/javascript" src="gx/gx.mainLoop.js"></script>
<script type="text/javascript" src="gx/gx.overlay2d.js"></script>
<script type="text/javascript" src="gx/gx.projectionHelper.js"></script>

<script type="text/javascript" src="game/supernova.js"></script>
<script type="text/javascript" src="game/shaderManager.js"></script>
<script type="text/javascript" src="game/textureManager.js"></script>
<script type="text/javascript" src="game/mainLoop.js"></script>

<script type="text/javascript" src="game/planet.js"></script>
<script type="text/javascript" src="game/solarSystem.js"></script>
<script type="text/javascript" src="game/debugPrinter.js"></script>

<!-- shaders -->
<script id="main_frag" type="x-shader/x-fragment" src="shaders\main_fragment.glsl"></script>
<script id ="main_vert" type="x-shader/x-vertex" src="shaders\main_vertex.glsl"></script>
<script id="sun_frag" type="x-shader/x-fragment" src="shaders\sun_fragment.glsl"></script>
<script id ="sun_vert" type="x-shader/x-vertex" src="shaders\sun_vertex.glsl"></script>

<script type="text/javascript">

    Math.PI2 = 2 * Math.PI;
    Math.Degree = Math.PI / 180;
    /*
    var earthRadius = 6371;
    var moonRadius = 1737.4 / earthRadius;
    var sunRadius = 5; //696000 / earthRadius;
    var distanceEarthMoon = 4; //384400 / earthRadius;
    var moonInclination = (5.14 / 180) * Math.PI; // inclination in relation to the sun's plane
    var moonObliquity = (6.58 / 180) * Math.PI ; // moon's axial tilt

    var earthRotationPeriod = 0.99726968;
    var moonTranslationPeriod = 27.321582 / earthRotationPeriod;
    var moonRotationPeriod = 27.321582 / earthRotationPeriod;
    var earthSunDistance = 10;// 150 * Math.pow(10, 6) / earthRadius;
    var earthTranslationPeriod = 365.25 / earthRotationPeriod; // days
    
    function raytraceObject(cameraPosition, viewProjectionMatrix, objectList, viewportPosition) {
        var directionScreenCoords = vec3.fromValues(viewportPosition[0], viewportPosition[1], 0);
        var inverse = mat4.create();
        mat4.invert(inverse, viewProjectionMatrix);
        
        var directionWorldCoords = vec3.create();
        vec3.transfromMat4(directionWorldCoords, directionScreenCoords, inverse);
        
        for (var i = 0; i < objectList.lenght; i++) {
            var obj = objectList[i];
            
            obj.intersects(cameraPosition, directionWorldCoords);
        }
    }
    
    function transformIntoScreenCoords(position, modelMatrix, viewProjectionMatrix) {
        var transformedPosition = vec3.create();
        vec3.transformMat4(transformedPosition, position, modelMatrix);
        vec3.transformMat4(transformedPosition, transformedPosition, viewProjectionMatrix);
        vec3.scale(transformedPosition, transformedPosition, 1 / transformedPosition[2]); // make values in range 0..1
        transformedPosition[0] = (glx.canvas.width / 2) * (transformedPosition[0] + 1);
        transformedPosition[1] = (glx.canvas.height / 2) * (transformedPosition[1] + 1);
        return transformedPosition;
    }
    */
    
    function webGLStart() {  
        var canvas = document.getElementById("canvas");        
        var mainLoop = new supernova.mainLoop(canvas);
        mainLoop.start();
    }
</script>


</head>


    <body onload="webGLStart();">
        <div>
            <canvas id="canvas" style="border: none;width: 100%;height: 100%;" width="1024" height="1024"></canvas>
        </div>
    </body>

</html>
